version: '3.8'

services:
  # Telegram Bot Service
  bot:
    build: .
    container_name: lifeos-bot
    command: python bot.py
    env_file:
      - .env
    restart: unless-stopped
    volumes:
      - ./logs:/app/logs
    depends_on:
      - dashboard

  # Streamlit Dashboard Service
  dashboard:
    build: .
    container_name: lifeos-dashboard
    command: streamlit run app.py --server.port=8501 --server.address=0.0.0.0
    env_file:
      - .env
    ports:
      - "8501:8501"
    restart: unless-stopped
    volumes:
      - ./logs:/app/logs

# Optional: Add a health check
  # healthcheck:
  #   image: curlimages/curl:latest
  #   depends_on:
  #     - dashboard
  #   command: curl -f http://dashboard:8501/_stcore/health || exit 1
  #   interval: 30s
  #   timeout: 10s
  #   retries: 3
